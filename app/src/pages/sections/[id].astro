---
import ArticleList from "../../components/ArticleList.svelte";
import SummaryBox from "../../components/SummaryBox.svelte";
import Layout from "../../layouts/Layout.astro";
import { getBaseUrl, getSectionArticles, loadFeedData } from "../../lib/data";

export async function getStaticPaths() {
  const data = loadFeedData();
  return data.sections.map((section) => ({
    params: { id: section.id },
    props: { section, data },
  }));
}

const { section, data } = Astro.props;
const articles = getSectionArticles(data, section.id);
const baseUrl = getBaseUrl();
---

<Layout title={section.name} activeId={section.id}>
  <SummaryBox
    summary={section.summary}
    icon={section.icon}
    baseUrl={baseUrl}
    client:load
  />

  <ArticleList
    articles={articles}
    sections={[section]}
    contextId={section.id}
    client:load
  />
</Layout>
